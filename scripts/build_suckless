#!/bin/bash

SRC_DIR="$HOME/suckless"

declare -A PROGRAM_PATHS=(
  [dwm]="$SRC_DIR/dwm"
  [st]="$SRC_DIR/st"
  [dmenu]="$SRC_DIR/dmenu"
  [dwmblocks]="$SRC_DIR/dwmblocks"
)

GREEN='\033[0;32m'
RED='\033[0;31m'
NC='\033[0m'

echo -e "${GREEN}Select the program(s) you want to build:${NC}"
echo "1) dwm"
echo "2) st"
echo "3) dmenu"
echo "4) dwmblocks"
echo "5) all"
echo -n "Enter numbers (e.g., 1 3): "
read -r choices

build_program() {
  local prog="$1"
  local dir="${PROGRAM_PATHS[$prog]}"

  if [ -d "$dir" ]; then
    echo -e "${GREEN}>> Compiling $prog...${NC}"
    cd "$dir" || exit 1
    make clean
    if make && sudo make install; then
      echo -e "${GREEN}$prog compiled and installed successfully!${NC}"
    else
      echo -e "${RED}Failed to build $prog${NC}"
    fi
  else
    echo -e "${RED}Directory not found: $dir${NC}"
  fi
}

for choice in $choices; do
  case $choice in
    1) build_program "dwm" ;;
    2) build_program "st" ;;
    3) build_program "dmenu" ;;
    4) build_program "dwmblocks" ;;
    5)
      for prog in "${!PROGRAM_PATHS[@]}"; do
        build_program "$prog"
      done
      ;;
    *) echo -e "${RED}Invalid choice: $choice${NC}" ;;
  esac
done

echo -e "${GREEN}>>> Done.${NC}"

